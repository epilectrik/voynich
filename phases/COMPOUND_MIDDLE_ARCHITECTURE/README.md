# COMPOUND_MIDDLE_ARCHITECTURE Phase

## Objective

Map the compound MIDDLE system across Currier B and related annotation layers. Determine whether the compositional identification pattern found at line-1 HT extends to other contexts (labels, body text, classified tokens).

## Background

Discovery chain from B_LINE_POSITION_HT:
1. Line-1 HT enrichment: 50.2% vs 29.8% body (C747-C750)
2. Line-1 HT is more B-native: 31.6% B-exclusive MIDDLEs vs 19.9%
3. Line-1 HT is more folio-specific: 21.7% folio-unique MIDDLEs vs 11.7%
4. Folio-unique MIDDLEs are compound forms: 84.8% contain core MIDDLEs

Hypothesis: Unique identification vocabulary is generated by combinatorially compounding core operational MIDDLEs.

## Key Findings

### T1: Length-Controlled Baseline
- **Observed compound rate**: 84.8%
- **Random baseline**: 54.9%
- **Elevation**: +29.9pp above chance
- **Z-score**: 6.09, p=0.0000
- **Verdict**: SIGNIFICANTLY_ABOVE_CHANCE

### T2: L-Placement Labels
| Language | Folio-Unique% | Compound% | Tokens |
|----------|---------------|-----------|--------|
| A (herbal) | 75.0% | 58.3% | 172 |
| B | 69.6% | 30.4% | 99 |
| NA (AZC) | 84.1% | 43.2% | 68 |

Labels show the same identification pattern as line-1 HT.

### T4: Classified vs UN (MAJOR FINDING)
| Metric | Classified | UN | Difference |
|--------|------------|-----|------------|
| Compound rate | 35.2% | **81.1%** | **+45.9pp** |
| Folio-unique rate | 2.3% | **64.5%** | **+62.3pp** |
| Mean MIDDLE length | 2.26 | 4.09 | +1.82 |

**Critical discovery**: 0 classified-only MIDDLEs exist. All 88 classified MIDDLEs also appear in UN. But 1,251 MIDDLEs appear ONLY in UN (84.3% compound).

**Conclusion**: UN = derived identification vocabulary built from base grammar.

### T5: Compound Predictors
- **Line position**: Line-1 is +5.0pp more compound
- **Folio uniqueness**: r = 0.553 correlation with compound rate
- **Class variation**: 0% to 100% across classes

### T6: Class Compound Profile
| Category | Classes | Tokens | % |
|----------|---------|--------|---|
| BASE-ONLY (0-5%) | 21 | 7,470 | 46.5% |
| COMPOUND-HEAVY (85%+) | 3 | 1,363 | 8.5% |

**Bimodality confirmed**: Grammar has two functional vocabularies.

### T7: Role-Compound Correlation
| Role | Compound Rate | Pattern |
|------|---------------|---------|
| FL | **0.0%** | ALL base-only |
| EN | 26.8% | Mixed |
| CC | 34.0% | Polarized |
| AX | 34.2% | Mostly low |
| FQ | **46.7%** | Compound-biased |

**FL uses 0% compound MIDDLEs and 0 kernel characters (k, h, e).**

## Structural Model

```
BASE GRAMMAR (88 MIDDLEs, 479 types, 49 classes)
    │
    │ combinatorial compounding
    ↓
DERIVED VOCABULARY (1,251 UN-only MIDDLEs)
    │
    │ folio-specific selection
    ↓
IDENTIFICATION TOKENS (line-1 HT, jar labels)

GRAMMAR HIERARCHY (by compound usage):
  FL (0.0%) ────── PRIMITIVE LAYER (atomic flow control)
  EN-CC-AX ─────── MIXED LAYER
  FQ (46.7%) ───── COMPOUND-BIASED LAYER
```

## Constraints Established

| # | Name | Finding |
|---|------|---------|
| C766 | UN Derived Vocabulary | UN is 81.1% compound, +45.9pp above classified |
| C767 | Class Compound Bimodality | 21 base-only classes, 3 compound-heavy |
| C768 | Role-Compound Correlation | FL=0%, FQ=46.7%, 46.7pp spread |
| C769 | Compound Context Prediction | Line-1, folio-unique, class all predictive |

## Connection to Existing Constraints

- C510-C513: Sub-component grammar (this phase extends framework)
- C511: Derivational productivity (12.67x) = this compounding mechanism
- C618: Unique MIDDLEs 95.7% PP-atom-containing = compound structure
- C747-C750: Line-1 HT enrichment findings

## Tests

| Test | Question | Status |
|------|----------|--------|
| T1 | Length-controlled baseline: Is 84.8% above chance? | DONE - YES (+29.9pp) |
| T2 | L-placement labels: Same compound pattern? | DONE - YES |
| T3 | Body folio-unique: Also compound? | SKIPPED |
| T4 | Classified vs UN: Different compound rates? | DONE - MAJOR FINDING |
| T5 | Compound predictors: Predict folio/section/role? | DONE - YES |
| T6 | Class compound profiles | DONE - BIMODAL |
| T7 | Role-compound correlation | DONE - FL=0% |

## Files

- `scripts/t1_length_baseline.py` - Length-controlled sanity test
- `scripts/t2_label_compound.py` - L-placement label analysis
- `scripts/t4_classified_compound.py` - Classified vs UN comparison
- `scripts/t5_compound_predictors.py` - Context prediction tests
- `scripts/t6_class_compound_profile.py` - Per-class compound profiles
- `scripts/t7_role_compound_correlation.py` - Role-compound mapping
- `results/*.json` - All test results
